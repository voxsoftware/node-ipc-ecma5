/*global describe, expect, it*/
'use strict';

var ipc = require('../../../../node-ipc');

describe('Test Cases for server: ', function testDescribe() {
    // Unix server verification //
    it('Verify unix server detects only 1 client out of 2 clients and receives message.', function testIt(done) {

        ipc.config.id = 'testWorld';
        ipc.config.retry = 1000;
        ipc.config.silent = false;

        var clientCounter = 0;
        ipc.config.maxConnections = 1;

        ipc.serve('/tmp/app.testWorld', function serverStarted() {
            ipc.server.on('connect', function connected() {
                clientCounter++;
            });
        });

        setTimeout(function clientCountDelay() {
            expect(clientCounter).toBe(ipc.config.maxConnections);
            ipc.server.stop();
            done();
        }, ipc.config.retry + ipc.config.retry);

        ipc.server.start();
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL25vZGUtaXBjL3NwZWMvc3VwcG9ydC9qYXNtaW5lVGVzdC9Vbml4L3VuaXhTb2NrZXRTZXJ2ZXIuc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0E7O0FBRUEsSUFBTSxNQUFNLFFBQVEsc0JBQVIsQ0FBTjs7QUFFTixTQUNJLHlCQURKLEVBRUksU0FBUyxZQUFULEdBQXVCOztBQUVuQixPQUNJLGlGQURKLEVBRUksU0FBUyxNQUFULENBQWdCLElBQWhCLEVBQXFCOztBQUVqQixZQUFJLE1BQUosQ0FBVyxFQUFYLEdBQWUsV0FBZixDQUZpQjtBQUdqQixZQUFJLE1BQUosQ0FBVyxLQUFYLEdBQW1CLElBQW5CLENBSGlCO0FBSWpCLFlBQUksTUFBSixDQUFXLE1BQVgsR0FBa0IsS0FBbEIsQ0FKaUI7O0FBTWpCLFlBQUksZ0JBQWMsQ0FBZCxDQU5hO0FBT2pCLFlBQUksTUFBSixDQUFXLGNBQVgsR0FBMEIsQ0FBMUIsQ0FQaUI7O0FBU2pCLFlBQUksS0FBSixDQUNJLG9CQURKLEVBRUksU0FBUyxhQUFULEdBQXdCO0FBQ3BCLGdCQUFJLE1BQUosQ0FBVyxFQUFYLENBQ0ksU0FESixFQUVJLFNBQVMsU0FBVCxHQUFvQjtBQUNoQixnQ0FEZ0I7YUFBcEIsQ0FGSixDQURvQjtTQUF4QixDQUZKLENBVGlCOztBQXFCakIsbUJBQ0ssU0FBUyxnQkFBVCxHQUEyQjtBQUN2QixtQkFBTyxhQUFQLEVBQXNCLElBQXRCLENBQTJCLElBQUksTUFBSixDQUFXLGNBQVgsQ0FBM0IsQ0FEdUI7QUFFdkIsZ0JBQUksTUFBSixDQUFXLElBQVgsR0FGdUI7QUFHdkIsbUJBSHVCO1NBQTNCLEVBS0EsSUFBSSxNQUFKLENBQVcsS0FBWCxHQUFpQixJQUFJLE1BQUosQ0FBVyxLQUFYLENBTnRCLENBckJpQjs7QUE4QmpCLFlBQUksTUFBSixDQUFXLEtBQVgsR0E5QmlCO0tBQXJCLENBRkosQ0FGbUI7Q0FBdkIsQ0FGSiIsImZpbGUiOiJ1bml4U29ja2V0U2VydmVyLnNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKmdsb2JhbCBkZXNjcmliZSwgZXhwZWN0LCBpdCovXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IGlwYyA9IHJlcXVpcmUoJy4uLy4uLy4uLy4uL25vZGUtaXBjJyk7XG5cbmRlc2NyaWJlKFxuICAgICdUZXN0IENhc2VzIGZvciBzZXJ2ZXI6ICcsXG4gICAgZnVuY3Rpb24gdGVzdERlc2NyaWJlKCl7XG4gICAgICAgIC8vIFVuaXggc2VydmVyIHZlcmlmaWNhdGlvbiAvL1xuICAgICAgICBpdChcbiAgICAgICAgICAgICdWZXJpZnkgdW5peCBzZXJ2ZXIgZGV0ZWN0cyBvbmx5IDEgY2xpZW50IG91dCBvZiAyIGNsaWVudHMgYW5kIHJlY2VpdmVzIG1lc3NhZ2UuJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uIHRlc3RJdChkb25lKXtcblxuICAgICAgICAgICAgICAgIGlwYy5jb25maWcuaWQgPSd0ZXN0V29ybGQnO1xuICAgICAgICAgICAgICAgIGlwYy5jb25maWcucmV0cnkgPSAxMDAwO1xuICAgICAgICAgICAgICAgIGlwYy5jb25maWcuc2lsZW50PWZhbHNlO1xuXG4gICAgICAgICAgICAgICAgbGV0IGNsaWVudENvdW50ZXI9MDtcbiAgICAgICAgICAgICAgICBpcGMuY29uZmlnLm1heENvbm5lY3Rpb25zPTE7XG5cbiAgICAgICAgICAgICAgICBpcGMuc2VydmUoXG4gICAgICAgICAgICAgICAgICAgICcvdG1wL2FwcC50ZXN0V29ybGQnLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBzZXJ2ZXJTdGFydGVkKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpcGMuc2VydmVyLm9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb25uZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjb25uZWN0ZWQoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50Q291bnRlcisrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChcbiAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNsaWVudENvdW50RGVsYXkoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoY2xpZW50Q291bnRlcikudG9CZShpcGMuY29uZmlnLm1heENvbm5lY3Rpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICBpcGMuc2VydmVyLnN0b3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgaXBjLmNvbmZpZy5yZXRyeStpcGMuY29uZmlnLnJldHJ5XG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlwYy5zZXJ2ZXIuc3RhcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG4pO1xuIl19